<!DOCTYPE html>
<html lang="en">
{% load static %}
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>AdmitionWala</title>
  <meta name="description" content="Find colleges, courses and career guidance across India. Search, compare and apply with one form at AdmitionWala.">
  <!-- Default social meta - pages may override the page_head block in child templates -->
  <meta property="og:site_name" content="AdmitionWala">
  <meta property="og:type" content="website">
  <meta property="og:title" content="AdmitionWala">
  <meta property="og:description" content="Find colleges, courses and career guidance across India.">
  <meta property="og:image" content="{% static 'college_logo.svg' %}">
  <meta property="og:url" content="{{ request.build_absolute_uri }}">
  <meta name="twitter:title" content="AdmitionWala - Find colleges & apply">
  <link rel="canonical" href="{{ request.build_absolute_uri }}">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@admitionwala">
  {% block page_head %}{% endblock %}
  <link rel="stylesheet" href="{% static 'custom.css' %}">
  <style>
      /* Use CSS variable for page background; value is injected by JS below to avoid template tags inside CSS */
      html, body {
        background: var(--page-bg-url) no-repeat center center fixed !important;
        background-size: cover !important;
        margin: 0 !important;
        height: 100%;
      }
  </style>
</head>
<body class="{% if page_background_url %}page-bg-present{% endif %}">
  <a class="skip-link" href="#main-content" style="position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden;">Skip to content</a>
  <!-- Default header block; child templates may override {% block header %} -->
  {% block header %}
  <header class="fallback-header" role="banner" aria-hidden="false">
    <div class="logo"><img src="{% static 'images/admitionwala_logo.svg' %}" alt="AdmitionWala" style="height:40px"/></div>
    <button class="menu-toggle" aria-label="Open menu" aria-expanded="false">
      <svg viewBox="0 0 24 18" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <g stroke="currentColor" stroke-width="2" stroke-linecap="round">
          <path class="bar-top" d="M2 3h20" />
          <path class="bar-mid" d="M2 9h20" />
          <path class="bar-bot" d="M2 15h20" />
        </g>
      </svg>
    </button>
  </header>
  {% endblock %}
  <div id="react-root"></div>
  <!-- React will render the header and background animations into #react-root -->

  <main id="main-content" class="container animated fadeInUp">
    {% block content %}{% endblock %}
  </main>
  <script>
    // Sticky header and mobile menu toggle
    (function(){
      var header = document.querySelector('.site-header');
      var hamb = document.querySelector('.hamburger');
      var nav = document.querySelector('.main-nav');
      window.addEventListener('scroll', function(){
        if(window.scrollY > 60) header.classList.add('sticky'); else header.classList.remove('sticky');
      });
      if(hamb){ hamb.addEventListener('click', function(){ document.body.classList.toggle('menu-open'); }); }
      // close menu on nav item click (mobile)
      nav && nav.addEventListener('click', function(e){ if(e.target.tagName==='A' && document.body.classList.contains('menu-open')) document.body.classList.remove('menu-open'); });
    })();
  </script>
  <script id="dj-data" type="application/json">
    {
      "user_authenticated": {{ request.user.is_authenticated|yesno:'true,false' }},
      "page_background_url": {% if page_background_url %}"{{ page_background_url|escapejs }}"{% else %}null{% endif %},
      "static_college_logo": "{% static 'college_logo.svg' %}"
    }
  </script>
  <script>
    try{
      window.__DJANGO__ = JSON.parse(document.getElementById('dj-data').textContent);
    }catch(e){ window.__DJANGO__ = { user_authenticated: false, page_background_url: null, static_college_logo: '/static/college_logo.svg' }; }
  </script>
  <script>
    // Set page background CSS variable from server-provided data (safe, no template tags)
    (function(){
      var dj = window.__DJANGO__ || {};
      var bg = dj.page_background_url || '/static/images/background.jpeg';
      try { document.documentElement.style.setProperty('--page-bg-url', "url('" + bg + "')"); } catch(e) { /* noop */ }
    })();
  </script>
  <script>
    // Hide fallback header when a template provides .site-header and wire fallback toggle to overlay
    (function(){
      var fallback = document.querySelector('.fallback-header');
      var hasSite = document.querySelector('.site-header');
      if(hasSite && fallback){ fallback.style.display='none'; }
      // Wire any menu-toggle to open mobile overlay
      var toggles = document.querySelectorAll('.menu-toggle, .hamburger');
      var overlay = document.getElementById('mobileNav');
      toggles && toggles.forEach(function(t){ t.addEventListener('click', function(e){ e.preventDefault(); overlay && overlay.classList.add('open'); overlay && overlay.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; }); });
    })();
  </script>
  <!-- React (via CDN) and our small app to render header/background -->
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="{% static 'js/react_app.js' %}"></script>
  <div class="footer">&copy; 2025 AdmitionWala.</div>
  <!-- Mobile navigation overlay -->
  <div class="mobile-nav-overlay" id="mobileNav" aria-hidden="true">
    <div class="mobile-nav-header">
      <div class="mobile-nav-logo"><img src="{% static 'images/admitionwala_logo.svg' %}" alt="AdmitionWala" style="height:36px"/></div>
      <button class="mobile-nav-close" id="mobileNavClose" aria-label="Close menu">&times;</button>
    </div>
    <nav class="mobile-nav-links" role="navigation" aria-label="Mobile Main Navigation">
      <a href="/colleges/">Explore Colleges</a>
      <a href="/courses/">All Courses</a>
      <a href="/careers/">Careers</a>
      <a href="/about/">About Us</a>
      <a href="/apply/">Apply</a>
      <a href="/admition-counseling/">Counseling</a>
    </nav>
    <div class="mobile-nav-contact">Call us: 1800-572-9877<br/>hello@admitionwala.com</div>
  </div>

  <!-- GitHub button removed as requested -->
  <script>
    // Mobile nav overlay toggle (accessible) with focus trap
    (function(){
      var toggle = document.querySelector('.menu-toggle') || document.querySelector('.hamburger');
      var overlay = document.getElementById('mobileNav');
      var closeBtn = document.getElementById('mobileNavClose');
      var focusableSelectors = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"])';
      var lastFocused = null;

      function getFocusable(){ return overlay ? Array.prototype.slice.call(overlay.querySelectorAll(focusableSelectors)) : []; }
      function openNav(){ lastFocused = document.activeElement; overlay.classList.add('open'); overlay.setAttribute('aria-hidden','false'); document.body.style.overflow='hidden'; var els = getFocusable(); if(els.length) els[0].focus(); }
      function closeNav(){ overlay.classList.remove('open'); overlay.setAttribute('aria-hidden','true'); document.body.style.overflow=''; if(lastFocused) lastFocused.focus(); }

  // Toggle handlers
  toggle && toggle.addEventListener('click', function(e){ e.preventDefault(); if(overlay.classList.contains('open')){ closeNav(); toggle.classList.remove('is-active'); toggle.setAttribute('aria-expanded','false'); } else { openNav(); toggle.classList.add('is-active'); toggle.setAttribute('aria-expanded','true'); } });
  closeBtn && closeBtn.addEventListener('click', function(e){ e.preventDefault(); closeNav(); toggle && toggle.classList.remove('is-active'); toggle && toggle.setAttribute('aria-expanded','false'); });

      // Close when a link inside is clicked
  overlay && overlay.addEventListener('click', function(e){ if(e.target.tagName==='A') { closeNav(); toggle && toggle.classList.remove('is-active'); toggle && toggle.setAttribute('aria-expanded','false'); } });

      // Close on ESC and trap focus when overlay is open
      document.addEventListener('keydown', function(e){
        if(e.key === 'Escape') return closeNav();
        if(e.key === 'Tab' && overlay.classList.contains('open')){
          var focusable = getFocusable();
          if(focusable.length === 0){ e.preventDefault(); return; }
          var first = focusable[0];
          var last = focusable[focusable.length -1];
          if(e.shiftKey && document.activeElement === first){ e.preventDefault(); last.focus(); }
          else if(!e.shiftKey && document.activeElement === last){ e.preventDefault(); first.focus(); }
        }
      });
    })();
  </script>
</body>
</html>
